import{_ as w,c as r,b as s,t as u,o as n,M as k,F as x,u as v,d as p,f as l,g as h,r as _,j as C}from"./index-CqHucJ5S.js";import{N as b}from"./NutrientCard-BcK1fx74.js";const H={name:"HistoryDayCard",props:{dayData:{type:Object,required:!0},dayKey:{type:Object,required:!0}},computed:{date(){return new Date(this.dayKey+"T00:00:00")},dayInWeek(){return new Intl.DateTimeFormat("en-US",{weekday:"long"}).format(this.date)},fullDate(){return new Intl.DateTimeFormat("en-US",{day:"numeric",month:"numeric",year:"numeric"}).format(this.date)}},methods:{showDayContent(){this.$emit("show-content",this.dayKey)}}},g={class:"day-name"},I={class:"day-full-date"};function F(o,t,i,y,d,e){return n(),r("div",{class:"history-day-card",onClick:t[0]||(t[0]=(...c)=>e.showDayContent&&e.showDayContent(...c))},[s("div",g,u(e.dayInWeek),1),s("div",I,u(e.fullDate),1)])}const N=w(H,[["render",F],["__scopeId","data-v-ed9de09d"]]),S={name:"HistoryFoodCard",props:{foodId:{type:String,required:!0},count:{type:Number,required:!0}},computed:{store(){return v()},food(){return x.find(o=>o.id===this.foodId)},micronutrients(){return!this.food||!this.food.micronutrients?[]:Object.keys(this.food.micronutrients).map(o=>k.find(i=>i.id===o).name)}}},V={key:0,class:"food-card"},j={class:"food-content"},O={class:"category"},W={class:"food-count"},$={key:0,class:"micronutrients"},M={class:"micronutrients-list"};function q(o,t,i,y,d,e){return e.food?(n(),r("div",V,[s("div",j,[s("h3",null,u(e.food.name),1),s("p",O,u(e.food.category),1),s("p",W,"Added: "+u(i.count)+"x",1),e.micronutrients.length>0?(n(),r("div",$,[s("div",M,[(n(!0),r(l,null,h(e.micronutrients,c=>(n(),r("span",{key:c,class:"nutrient-tag"},u(c),1))),128))])])):p("",!0)])])):p("",!0)}const B=w(S,[["render",q],["__scopeId","data-v-97e26dfe"]]),K={name:"HistoryView",components:{HistoryDayCard:N,HistoryFoodCard:B,NutrientCard:b},data(){return{showedContent:""}},methods:{micronutrientsWithStats(o){return Object.keys(this.store.weeklyHistory[o].stats).map(y=>{const d=k.find(f=>f.id===y),e=d.maxValue,c=this.store.weeklyHistory[o].stats[y],m=Math.min(c/e*100,100);return{id:d.id,name:d.name,type:d.type,currentValue:c,maxValue:e,percentage:m}})},showContent(o){!this.showedContent||this.showedContent!==o?this.showedContent=o:this.showedContent=""}},computed:{store(){return v()},history(){return this.store.weeklyHistory||{}},sortedHistoryEntries(){return Object.entries(this.history).sort((o,t)=>o[0].localeCompare(t[0]))},emptyContainersCount(){return Math.max(0,7-Object.keys(this.history).length)},foodsWithCounts(){if(this.showedContent){const o=this.foods,t={};for(const i of o)t[i]=(t[i]||0)+1;return t}return{}},foods(){return this.store.weeklyHistory[this.showedContent].foods}}},E={class:"history-page"},T={class:"history-cards"},A={key:0,class:"day-content"},U={class:"content-box content-box-foods"},L={class:"day-content-left"},Y={class:"content-box content-box-micronutrients"},z={class:"day-content-right"};function G(o,t,i,y,d,e){const c=_("HistoryDayCard"),m=_("HistoryFoodCard"),f=_("NutrientCard");return n(),r("div",E,[t[3]||(t[3]=s("h2",{class:"history-title"},"Your 7 days history",-1)),s("div",T,[(n(!0),r(l,null,h(e.emptyContainersCount,a=>(n(),r("div",{key:"empty-"+a,class:"empty-container"},[...t[0]||(t[0]=[s("span",{class:"empty-container-text"},"No data",-1)])]))),128)),(n(!0),r(l,null,h(e.sortedHistoryEntries,([a,D])=>(n(),C(c,{key:a,dayData:D,dayKey:a,onShowContent:e.showContent},null,8,["dayData","dayKey","onShowContent"]))),128))]),d.showedContent?(n(),r("div",A,[s("div",U,[t[1]||(t[1]=s("h3",{class:"content-box-title"},"Foods",-1)),s("div",L,[(n(!0),r(l,null,h(Object.keys(e.foodsWithCounts),a=>(n(),C(m,{key:a,foodId:a,count:e.foodsWithCounts[a]},null,8,["foodId","count"]))),128))])]),s("div",Y,[t[2]||(t[2]=s("h3",{class:"content-box-title"},"Micronutrients",-1)),s("div",z,[(n(!0),r(l,null,h(e.micronutrientsWithStats(d.showedContent),a=>(n(),C(f,{key:a.id,nutrient:a},null,8,["nutrient"]))),128))])])])):p("",!0)])}const Q=w(K,[["render",G],["__scopeId","data-v-472de2bc"]]);export{Q as default};
